OT2.Util = {
    init_mobile: "13888888888",
    trim: function(t) {
        return t.replace(/^\s+|\s+$/, "")
    },
    substitute: function(t, e) {
        return t.replace(/\{\{\s*(\w+)\s*\}\}/, function(t, i) {
            return e[i] || ""
        })
    },
    dropList: function(t, e, i) {
        var n = null;
        i = i || 0, t.on("mouseover", function() {
            e.show(), n && clearTimeout(n), n = null
        }).on("mouseout", function() {
            return !n && void(n = setTimeout(function() {
                e.hide()
            }, i))
        })
    },
    sn: function(t) {
        var e = "ABCDEFGH".split("");
        return e[t] || "A"
    },
    chinesesn: function(t) {
        var e = ["一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十"];
        return e[t] || "〇"
    },
    circlesn: function(t) {
        var e = ["①", "②", "③", "④", "⑤", "⑥", "⑦", "⑧", "⑨", "⑩", "⑪", "⑫", "⑬", "⑭", "⑮", "⑯", "⑰", "⑱", "⑲", "⑳"];
        return e[t] || "①①"
    },
    Template: _.once(function() {
        return new OT2.Template
    }),
    selectElement: function(t) {
        var e = null;
        document.selection ? (e = document.body.createTextRange(), e.moveToElementText(t), e.select()) : window.getSelection && (e = document.createRange(), e.selectNode(t), window.getSelection().addRange(e))
    },
    alert: function(t, e) {
        t = '<div style="padding:45px 10px; text-align: center;">' + t + "</div>";
        var i = dialog({
            title: "温馨提示",
            content: t,
            fixed: !0,
            width: 400
        });
        return i.showModal(), "undefined" != typeof e && 0 != e || setTimeout(function() {
            i.close()
        }, 2e3), i
    },
    verify: function(t) {
        paper.verify_call = t, paper.refreshCaptcha(), msg = '<div  style="padding:40px 10px; text-align: center;"><img id="zujuan-captcha" src="/" onclick="paper.refreshCaptcha()" style="vertical-align: middle;"><input type="text" placeholder="请输入图形验证码" name="verifycode" style="width:120px;height:32px;padding:0 5px;border:1px solid #ddd;line-height:32px;font-size:12px;color: #333;"><button id="verify" onclick="paper.checkVerify()" style="width:80px;height:34px;border:0;margin-left: 5px;background:#3db06e;color:#fff;vertical-align: middle;">确定';
        var e = dialog({
            id: "checkform",
            title: "温馨提示",
            content: msg,
            fixed: !0,
            width: 400,
            cancelVal: "关闭",
            dialogClass: "no-close",
            cancel: function(t, e) {
                paper.verify = !1
            }
        });
        return e.showModal(), $(".ui-dialog-button").hide(), e
    },
    getCode: function(t) {
        var e = "/site/send-validate-code",
            i = $(t).attr("v_from");
        if (i && (e += "?v_from=" + i), "function" == typeof t.fn) return t.fn();
        var n = !1,
            r = null,
            a = 60,
            o = $("#mobile").val(),
            c = function(t) {
                return 0 == a ? (a = 60, n = !1, clearTimeout(r), t.innerHTML = "获取验证码", !1) : (t.innerHTML = "重新获取（" + a + "）", a--, void(r = setTimeout(function() {
                    c(t)
                }, 1e3)))
            };
        t.fn = function() {
            return !n && (n = !0, c(t), $.post(e, {
                mobile: o
            }, function(t) {
                0 == t.errCode || (n = !1, $("#mobile").data("res", t.data), $("#mobile").trigger("validate"))
            }), void 0)
        }, t.fn()
    },
    calcItemWidth: function(t) {
        var e = Number(t.innerWidth()),
            i = t.find(".op-item"),
            n = i.length,
            r = _.map(i, function(t) {
                var e = 0,
                    i = $(t);
                return "undefined" != typeof i.data("ww") ? e = Number(i.data("ww")) : (e = Number($(t).width()), $(t).data("ww", e)), e
            }),
            a = _.map(i, function(t) {
                var e = 0,
                    i = $(t);
                return "undefined" != typeof i.data("hh") ? e = Number(i.data("hh")) : (e = Number(i.height()), i.data("hh", e)), e
            }),
            o = _.max(a),
            c = _.max(r);
        if (2 * c >= e) return i.each(function() {
            var t = $(this).height();
            $(this).find(".op-item-nut").css({
                "margin-top": (t - 24) / 2 + "px"
            })
        }), t.find(".op-item").css({
            width: "100%",
            "margin-right": 0
        }), !1;
        if (n <= 4)
            if (c * n >= e) {
                var l = e / 2;
                l < c && (l = e), t.find(".op-item").css({
                    width: Math.floor(l) + "px",
                    "margin-right": 0
                })
            } else if (4 * c >= e) {
            var l = e / 3;
            l < c && (l = e / 2), t.find(".op-item").css({
                width: Math.floor(l) + "px",
                "margin-right": 0
            })
        } else {
            var l = e / 4;
            l < c && (l = e / 2), t.find(".op-item").css({
                width: Math.floor(l) + "px",
                "margin-right": 0
            })
        } else 4 * c >= e ? t.find(".op-item").css({
            width: Math.floor(e / 2) + "px",
            "margin-right": 0
        }) : c * n >= e ? t.find(".op-item").css({
            width: Math.floor(e / 4) + "px",
            "margin-right": 0
        }) : t.find(".op-item").css({
            width: "100%",
            "margin-right": 0
        });
        t.find(".op-item-nut").css({
            "margin-top": (o - 24) / 2 + "px"
        }), t.find(".op-item-meat").each(function() {
            var t = $(this).height();
            $(this).css({
                "margin-top": (o - t) / 2 + "px"
            })
        }), t.find(".op-item").css({
            height: o + "px",
            clear: "none"
        })
    }
}, OT2.Template = function() {
    var t = {};
    this.jst = {};
    var e = this;
    return $("[data-template]").each(function() {
        var i = $(this).data("template");
        if ("get" == i) throw new Error("模板名称不能是get");
        t[i] = $.trim(this.innerHTML.toString()), e.jst[i] = _.template(t[i])
    }), this.data = t, this
}, OT2.Template.prototype.get = function(t) {
    return this.data[t] || ""
}, OT2.Event = function() {
    this.handlers = []
}, OT2.Event.prototype = {
    publish: function(t) {
        var e = [].slice.call(arguments, 1),
            i = this.handlers[t];
        if (!i || 0 == i.length) return !1;
        for (var n, r = 0; n = i[r++];) n.apply(this, e)
    },
    intervalPublish: function(t, e) {
        var i = this,
            n = [].slice.call(arguments, 2),
            r = this.handlers[t];
        if (!r || 0 == r.length) return !1;
        var a = function(t) {
            var o = r[t];
            o && (o.apply(i, n), setTimeout(function() {
                a(++t)
            }, e))
        };
        setTimeout(function() {
            a(0)
        }, e)
    },
    subscribe: function(t, e) {
        this.handlers[t] || (this.handlers[t] = []), this.handlers[t].push(e)
    },
    removeSubscribe: function(t, e) {
        var i = this.handlers[t];
        if (!i) return !1;
        if (!e) return i && (i.length = 0), !1;
        for (var n = i.length - 1; n > 0; n--) {
            var r = i[n];
            r == e && i.splice(n, 1)
        }
    }
};
OT2.Field = function() {
    var r = function(t, i) {
        return this instanceof r ? (this.errorMsg = null, this.ajaxErrorMsg = null, this.handlers = [], this.el = t, this.$el = $(t), "undefined" == typeof i && (i = {}), this.$boudingBox = i.boudingBox || this.$el.parent(".reg-form-input"), this.$tipbox = i.tipbox || this.$boudingBox.find(".fm-warn"), this.$tipboxTxt = i.tipboxTxt || this.$tipbox.find("p"), void(this.warnClass = i.warnClass || "active-warn")) : new r(t, i)
    };
    return r.prototype = {
        addRule: function(r, t) {
            var i = this,
                s = [].slice.call(arguments, 2),
                o = s[s.length - 1],
                n = function() {
                    var r = $.trim(i.$el.val());
                    s.unshift(r);
                    var n = t.apply(i, s);
                    return o !== !1 && (n ? (i.errorMsg = n, i.showError()) : (i.errorMsg = null, i.removeError()), i.errorMsg)
                };
            this.handlers.push(n), this.$el.on(r, n)
        },
        addAjaxRule: function(r, t) {
            var i = this,
                s = [].slice.call(arguments, 2),
                o = function() {
                    var r = $.trim(i.$el.val());
                    s.unshift(r);
                    var o = t.apply(i, s);
                    $.when(o).done(function(r) {
                        0 == r.errCode && (i.ajaxErrorMsg = null, i.removeError())
                    }).fail(function(r) {
                        i.ajaxErrorMsg = r.message, i.showError(r.message)
                    })
                };
            this.$el.on(r, o)
        },
        checkIt: function() {
            if (this.errorMsg) return this.errorMsg;
            for (var r, t = 0; r = this.handlers[t++];) {
                var i = r();
                if (i) return i
            }
            return this.ajaxErrorMsg ? (this.showError(this.ajaxErrorMsg), this.ajaxErrorMsg) : null
        },
        getVal: function() {
            return $.trim(this.$el.val())
        },
        showError: function(r) {
            this.$boudingBox.addClass(this.warnClass), r = r || this.errorMsg, this.$tipboxTxt.html(r), this.$tipbox.show()
        },
        removeError: function() {
            this.$boudingBox.removeClass(this.warnClass), this.$tipboxTxt.html(""), this.$tipbox.hide()
        }
    }, r
}();
OT2.LocalData = {
    userData: null,
    name: location.hostname,
    isLocalStorage: "undefined" != typeof localStorage,
    init: function() {
        if (!this.userData) try {
            this.userData = document.createElement("INPUT"), this.userData.type = "hidden", this.userData.style.display = "none", this.userData.addBehavior("#default#userData"), document.body.appendChild(this.userData);
            var e = new Date;
            e.setDate(e.getDate() + 365), this.userData.expires = e.toUTCString()
        } catch (t) {
            return !1
        }
        return !0
    },
    setLocal: function(e, t) {
        this.isLocalStorage ? localStorage.setItem(e, t) : this.init() && (this.userData.load(this.name), this.userData.setAttribute(e, t), this.userData.save(this.name))
    },
    set: function(e, t, a) {
        "undefined" != typeof USER.uid && (this.setLocal(e, t), "undefined" == typeof a ? $.post("/ajax/set-basket", {
            key: e,
            value: t
        }).done(function() {}) : $.ajax({
            type: "post",
            url: "/ajax/set-basket",
            data: {
                key: e,
                value: t
            },
            async: a
        }))
    },
    getLocal: function(e) {
        return this.isLocalStorage ? localStorage.getItem(e) : this.init() ? (this.userData.load(this.name), this.userData.getAttribute(e)) : null
    },
    get: function(e) {
        var t = null,
            a = this;
        if ("undefined" != typeof USER.uid) {
            var i = this.getCookie("has_" + e + "_" + USER.uid);
            t = this.getLocal(e), i && t && "{}" != t || $.ajax({
                type: "get",
                url: "/ajax/get-basket",
                data: {
                    key: e
                },
                async: !1,
                success: function(i) {
                    200 == i.res && (a.setCookie("has_" + e + "_" + USER.uid, 1), a.removeLocal(e), t = i.data)
                }
            })
        }
        return t
    },
    setCookie: function(e, t, a) {
        var i = new Date;
        i.setTime(i.getTime() + 60 * a * 60 * 1e3), document.cookie = e + "=" + t + ";path=/"
    },
    getCookie: function(e) {
        for (var t = document.cookie.split("; "), a = 0; a < t.length; a++) {
            var i = t[a].split("=");
            if (i[0] == e) return decodeURI(i[1])
        }
    },
    removeLocal: function(e) {
        this.isLocalStorage ? localStorage.removeItem(e) : this.init() && (this.userData.load(this.name), this.userData.removeAttribute(e), this.userData.save(this.name))
    },
    remove: function(e, t) {
        "undefined" != typeof USER.uid && (this.removeLocal(e), "undefined" == typeof t ? $.get("/ajax/remove-basket", {
            key: e
        }).done(function() {}) : $.ajax({
            type: "get",
            url: "/ajax/remove-basket",
            data: {
                key: e
            },
            async: !1
        }))
    }
};